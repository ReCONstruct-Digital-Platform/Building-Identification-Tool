{% extends 'buildings/base.html' %}

{% block content %}
{% load humanize %}

{{ building_latest_view_data | json_script:"building_latest_view_data" }}

<script src="{% static 'scripts/map.js' %}"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.0.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script> -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
<link rel="stylesheet" type="text/css" href="{% static 'buildings/style.css'%}" media = "print">

<script>
    var map;
    var sv;
    var m_marker;
    var sv_marker;

    var panoRequest;
    var building_coord;


    function initMaps() {
      const svService = new google.maps.StreetViewService();

      // If we have already seen the building, get the latest user defined view
      const building_latest_view_data = JSON.parse(document.getElementById('building_latest_view_data').textContent);

      if (building_latest_view_data) {
        panoRequest = {
          pano: building_latest_view_data['sv_pano']
        };

        building_coord = {
          lat: building_latest_view_data['marker_lat'],
          lng: building_latest_view_data['marker_lng']
        };
      }
      // No preivously saved view data
      // we will search for best panorama
      else {
        building_coord = {
          lat: parseFloat("{{ building.lat }}"),
          lng: parseFloat("{{ building.lon }}")
        };

        panoRequest = {
          location: building_coord,
          preference: google.maps.StreetViewPreference.BEST,
          radius: 50,
          source: google.maps.StreetViewSource.OUTDOOR
        };
      }

      function findPanoramaByRadius(panoRequest, building_coord) {

        console.log(`Searching using radius`);

        svService.getPanorama(panoRequest, function(panoData, status) {
          if (status === google.maps.StreetViewStatus.OK) {

            console.log("Found Panorama")
            // Calculate the correct direction the camera must face
            // based on the panorama default location and the building location
            const heading = google.maps.geometry.spherical.computeHeading(panoData.location.latLng, building_coord);

            sv = new google.maps.StreetViewPanorama(
              document.getElementById('streetview'),
              {
                  position: building_coord,
                  center: building_coord,
                  zoom: 0,
                  pov: {
                    heading: heading,
                    pitch: 0,
                  },
              });

              sv_marker = new google.maps.Marker({
                position: building_coord,
                map: sv,
                title: "Building",
                draggable: true,
              });

              sv_marker.addListener("dragend", ()=> {
                m_marker.setPosition(sv_marker.getPosition());
              })

              // Setting the panorama after the marker has been defined,
              // otherwise the marker does not show for some reason!
              // https://stackoverflow.com/questions/23498921/google-street-view-with-custom-panorama-and-markers
              sv.setPano(panoData.location.pano);
              window.sv = sv;

              map = new google.maps.Map(document.getElementById("satmap"), {
                center: building_coord,
                mapTypeId: 'satellite',
                zoom: 18,
                // streetViewControl: false,
                rotateControl: false,
                controlSize: 25,
              });

              m_marker = new google.maps.Marker({
                position: building_coord,
                map: map,
                draggable: true,
              });

              map.setStreetView(sv);
              window.map = map;

              // Listen to the marker being dragged and update the one on the streetview to match
              m_marker.addListener("dragend", ()=> {
                sv_marker.setPosition(m_marker.getPosition());
              })
          }
          else {
            var radius = panoRequest.radius
            //Handle other statuses here
            if (radius > 200) {
              console.log(`Could not find a street view within ${radius}m of building! Giving up.`);
              elem = document.createElement('div');
              elem.innerText = "Could not find Panorama for location";
              document.getElementById("streetview").appendChild(elem);
              return False;
            }
            else {
              console.log(`Could not find street view within ${radius}m, trying again within ${radius+50}m.`)
              panoRequest.radius = panoRequest.radius + 50;
              findPanoramaByRadius(panoRequest, building_coord);
            }
          }
        });
        }

      function findPanoramaById(panoRequest, building_coord) {
        console.log(`Searching for panorama using Id: ${panoRequest.pano}`);

        svService.getPanorama(panoRequest, function(panoData, status) {
          if (status === google.maps.StreetViewStatus.OK) {

            const heading = building_latest_view_data['sv_heading'];
            const zoom = building_latest_view_data['sv_zoom'];
            const pitch = building_latest_view_data['sv_pitch'];

            sv = new google.maps.StreetViewPanorama(
              document.getElementById('streetview'),
              {
                  position: building_coord,
                  center: building_coord,
                  zoom: zoom,
                  pov: {
                    heading: heading,
                    pitch: pitch,
                  },
              });

              sv_marker = new google.maps.Marker({
                position: building_coord,
                map: sv,
                title: "Building",
                draggable: true,
              });

              sv_marker.addListener("dragend", ()=> {
                m_marker.setPosition(sv_marker.getPosition());
              })

              // Setting the panorama after the marker has been defined,
              // otherwise the marker does not show for some reason!
              // https://stackoverflow.com/questions/23498921/google-street-view-with-custom-panorama-and-markers
              sv.setPano(panoData.location.pano);
              window.sv = sv;

              map = new google.maps.Map(document.getElementById("satmap"), {
                center: building_coord,
                mapTypeId: 'satellite',
                zoom: 18,
                // streetViewControl: false,
                rotateControl: false,
                controlSize: 25,
              });

              m_marker = new google.maps.Marker({
                position: building_coord,
                map: map,
                draggable: true,
              });

              map.setStreetView(sv);
              window.map = map;

              // Listen to the marker being dragged and update the one on the streetview to match
              m_marker.addListener("dragend", ()=> {
                sv_marker.setPosition(m_marker.getPosition());
              })
          }
          else {
            console.log(`Could not find panorama id ${panoRequest.pano}. Searching using radius`);
            // Making a radius search request
            panoRequest = {
              location: building_coord,
              preference: google.maps.StreetViewPreference.BEST,
              radius: 50,
              source: google.maps.StreetViewSource.OUTDOOR
            };
            return findPanoramaByRadius(panoRequest, building_coord);
          }
        });
      }

      if (building_latest_view_data)
        findPanoramaById(panoRequest, building_coord);
        else
        findPanoramaByRadius(panoRequest, building_coord);
    }

    window.initMaps = initMaps;
</script>

<section class="container-wide mb-3">
  <div class="classify-top-row">
    <div class="building-nav building-nav-left">
      <a id="prev-building-link">&laquo;&laquo; Prev</a>
    </div>
    <div class="building-info">

      <div class="building-info-col">
        <div class="building-id">
          <h4>
            Building #{{ building.id }}
          </h4>
        </div>
        <div>
          {{ building.formatted_address }}
        </div>
        <div class="building-cubf">
          CUBF {{ building.cubf }}: {{ building.cubf_name }}
        </div>
      </div>
      <div class="building-info-col ml-5">
        <div>
          Const. year:
          {% if building.construction_year != 9999 %}
            {{ building.construction_year }}
            {% if building.year_real_esti == 'E' %}
            (Est.)
            {% endif %}
          {% else %}
          &mdash;
          {% endif %}
        </div>
        <div>
          Max floors:
          {% if building.max_num_floor %}
          {{ building.max_num_floor }}
          {% else %}
          &mdash;
          {% endif %}
        </div>
        <div>
          Floor area:
          {% if building.floor_area != 9999.0 %}
          {{ building.floor_area }} m<sup>2</sup>
          {% else %}
          &mdash;
          {% endif %}
        </div>
      </div>

      <div class="building-info-col ml-5">
        <div>
          Type const.:
          {% if building.type_const %}

          {% include "buildings/utils/construction_type.html" with type_const=building.type_const %}

          {% else %}
          &mdash;
          {% endif %}
        </div>
        <div>
          Property value: ${{ building.value_prop|intcomma }}
        </div>
        <div>
          Non-res premises:
          {% if building.num_non_res %}

          {{ building.num_non_res }}
          {% else %}
          &mdash;
          {% endif %}
        </div>
      </div>
      <button id="btn-no-building" type="button" class="btn btn-danger btn-no-building ml-5">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle-fill" viewBox="0 0 16 16">
          <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
        </svg>
        No Building
      </button>
    </div>
    <div class="building-nav building-nav-right">
      <a id="next" href="{% url 'buildings:classify' next_building %}">Next &raquo;&raquo;</a>
    </div>
  </div>
</section>

<section class="container-wide">
  <!--overall container-->
  <div class="streetview-and-map-container" >
    <div class="streetview-container ml-3">
      <div id="streetview"></div>
    </div>
    <div id="dragbar"></div>

    <!--min width here style = 'min-width: 42%"-->
    <div class="map-and-submit-container mr-3"  style = 'min-width: 42%' >

      <!--navigation bar-->
      <nav >
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <button class="nav-link active" id="nav-satellite-tab" data-bs-toggle="tab" data-bs-target="#nav-satellite" type="button" role="tab" aria-controls="nav-satellite" aria-selected="true" >Satellite</button>
          <button class="nav-link" id="nav-survey-tab" data-bs-toggle="tab" data-bs-target="#nav-survey" type="button" role="tab" aria-controls="nav-survey" aria-selected="false" onclick={TestsFunction()}>Survey</button>
        </div>
      </nav>

      <!--division: division of satellite image and survey questionnaires -->
      <div class="tab-content" id="nav-tabContent" >
        <!-- TestsFunction() script-->
        <div class="tab-pane show" id="nav-survey" role="tabpanel" aria-labelledby="nav-survey-tab"  style="display: none;">
          <!--$(document).ready(function() -->
          <!-- style sheet section 0 -->

          <!--below is the first scrolling survey -->
          <div id="scroll">
            <br>
            <div class="text-center">
              <h5>
                <strong>Building Identification Survey Round 1 </strong>
              </h5>
            </div>
            <hr />

            <form id="building-submission-form" action="{% url 'buildings:classify' building.id %}" method="post">
              <!-- Necessary for security -->
              {% csrf_token %}

              <!-- Q1 -->
              <fieldset class="q-container pl-5 pb-3">
                <legend class="q-header pb-1 ">
                  <strong>Q1: Does the building have a simple footprint?</strong>
                </legend>
                <div id="Q1" class="q-choices survey-3col browsers" >
                  <label for ="Y1"><input id = "Y1" class="mr-1" type="radio" name="Q1" value="yes" required />Yes</label>
                  <label for ="N1"><input id = "N1" class="mr-1" type="radio" name="Q1" value="no" required />No</label>
                 </div>
              </fieldset>

              <!-- Q2 -->
              <fieldset class="q-container pl-5 pb-3">
                <legend class="q-header pb-1">
                  <strong>Q2: Does the building have a simple volumetric form?</strong>
                </legend>
                <div id="Q2" class="q-choices survey-3col" >
                  <label for="Y2"><input id="Y2" class="mr-1" type="radio" name="Q2" value="yes"  required/>Yes</label>
                  <label for="N2"><input id="N2" class="mr-1" type="radio" name="Q2" value="no"  required/>No</label>
                 </div>
              </fieldset>

             <!-- Q3 -->
             <fieldset class="q-container pl-5 pb-3">
              <legend class="q-header pb-1">
                <strong>Q3: How many storeys above-ground does the building have?</strong>
              </legend>
               <div id="Q3" class="q-choices survey-3col Q3" >
                 <div class = "specify">
                   <label for="Q3_1"  class = "mr-1"><input id = "Q3_1"  type="radio" name = "Q3" class = "mr-1 specify"  required>Number of storeys = </label>
                   <input id="I3" class = "mr-1" type="number"  name="Q3" min="0" disabled/>
                 </div>
                 <label for="U3"><input id="U3" class="mr-1" type="radio" name="Q3" value="unsure" required/>Unsure</label>
               </div>
             </fieldset>

              <!-- Q4 -->
              <fieldset class="q-container pl-5 pb-3">
              <legend class="q-header pb-1">
                <strong>Q4: Does the building have a basement?</strong>
              </legend>
              <div id="Q4" class="q-choices survey-3col" >
                <label for="Y4"><input id="Y4" class="mr-1" type="radio" name="Q4" value="yes"  required/>Yes</label>
                <label for="N4"><input id="N4" class="mr-1" type="radio" name="Q4" value="no"  required/>No</label>
                <label for="U4"><input id="U4" class="mr-1" type="radio" name="Q4" value="unsure" required/>Unsure</label>
              </div>
             </fieldset>

            <!-- Q5 -->
            <fieldset class="q-container pl-5 pb-3">
              <legend class="q-header pb-1">
                <strong>Q5: Are there obstructions to machine access around the building (within 3m or less)? Select all that apply.</strong>
              </legend>
              <div id="Q5">
              <label for="Q5_1"><input id="Q5_1" class="mr-1" type="checkbox" name="Q5" value="Important_trees_or_landscaping" onclick='deRequire("Q5")' required/>Important trees or landscaping</label><br>
              <label for="Q5_2"><input id="Q5_2" class="mr-1" type="checkbox" name="Q5" value="Buildings"  onclick='deRequire("Q5")' required/>Buildings</label><br>
              <label for="Q5_3"><input id="Q5_3" class="mr-1" type="checkbox" name="Q5" value="Overhead_wires"  onclick='deRequire("Q5")' required/>Overhead wires, including those blocking general access to site</label><br>
              <label for="Q5_4"><input id="Q5_4" class="mr-1" type="checkbox" name="Q5" value="Overhead_wires"  onclick='deRequire("Q5")' required/>No significant obstructions</label><br>
              <div class = "specify">
                <label for="Q5_51" class = "mr-1"><input id = "Q5_51" type="checkbox" class = "mr-1" name="Q5"  onclick='deRequire("Q5"); deDisabled("Q5_51")' required>Other (specify): </label>
                <input id="Q5_5" type = "text" name="Q5_5_value" disabled />
              </div>
              </div>
            </fieldset>

            <!-- Q6 -->
            <fieldset class="q-container pl-5 pb-3">
              <legend class="q-header pb-1">
                <strong>Q6: Are there significant appendages to the building faces? Select all that apply.</strong>
              </legend>
              <div id="Q6">
                <label for="Q6_1"><input id="Q6_1" class="mr-1" type="checkbox" name="Q6" value="Canopies"  onclick='deRequire("Q6")' required/>Canopies/overhangs/eaves</label><br>
                <label for="Q6_2"><input id="Q6_2" class="mr-1" type="checkbox" name="Q6" value="Balconies" onclick='deRequire("Q6")' required/>Balconies</label><br>
                <label for="Q6_3"><input id="Q6_3" class="mr-1" type="checkbox" name="Q6" value="Porches/stoops"  onclick='deRequire("Q6")' required/>Porches/stoops</label><br>
                <label for="Q6_4"><input id="Q6_4" class="mr-1" type="checkbox" name="Q6" value="Vestibules"  onclick='deRequire("Q6")' required/>Vestibules</label><br>
                <label for="Q6_5"><input id="Q6_5" class="mr-1" type="checkbox" name="Q6" value="No_significant_appendages"  onclick='deRequire("Q6")' required/>No significant appendages</label><br>

              <div class = "specify">
                <label for="Q6_61" class = "mr-1"><input id = "Q6_61" type="checkbox" class = "mr-1" name="Q6"  onclick='deRequire("Q6"); deDisabled("Q6_61")' required>Other (specify): </label>
                <input id="Q6_6" type = "text" name="Q6_6_value" disabled />
              </div>
              </div>
            </fieldset>

            <!-- Q7 -->
            <fieldset class="q-container pl-5 pb-3">
              <legend class="q-header pb-1">
                <strong>Q7: What type of exterior cladding does the building appear to have? Select all that apply.</strong>
              </legend>
              <div id="Q7" class="q-choices survey-3col" >
                <label for="Q7_1"><input id="Q7_1" class="mr-1" type="checkbox" name="Q7" value="Concrete"  onclick='deRequire("Q7")' required/>Concrete</label>
                <label for="Q7_2"><input id="Q7_2" class="mr-1" type="checkbox" name="Q7" value="Plaster" onclick='deRequire("Q7")' required/>Plaster</label>
                <label for="Q7_3"><input id="Q7_3" class="mr-1" type="checkbox" name="Q7" value="Wood"  onclick='deRequire("Q7")' required/>Wood</label>
                <label for="Q7_4"><input id="Q7_4" class="mr-1" type="checkbox" name="Q7" value="Vinyl"  onclick='deRequire("Q7")' required/>Vinyl</label>
                <label for="Q7_5"><input id="Q7_5" class="mr-1" type="checkbox" name="Q7" value="Curtain_Wall"  onclick='deRequire("Q7")' required/>Curtain Wall</label>
                <label for="Q7_6"><input id="Q7_6" class="mr-1" type="checkbox" name="Q7" value="Metal"  onclick='deRequire("Q7")' required/>Metal</label>
                <label for="Q7_7"><input id="Q7_7" class="mr-1" type="checkbox" name="Q7" value="Brick_masonry"  onclick='deRequire("Q7")' required/>Brick masonry</label>
                <label for="Q7_8"><input id="Q7_8" class="mr-1" type="checkbox" name="Q7" value="Stone_masonry"  onclick='deRequire("Q7")' required/>Stone masonry</label>
                <label for="Q7_9"><input id="Q7_9" class="mr-1" type="checkbox" name="Q7" value="Unsure"  onclick='deRequire("Q7")' required/>Unsure</label>

              <div class = "specify">
                <label for="Q7_101" class = "mr-1"><input id = "Q7_101" type="checkbox" class = "mr-1" name="Q7"  onclick='deRequire("Q7"); deDisabled("Q7_101")' required>Other (specify): </label>
                <input id="Q7_10" type = "text"  name="Q7_10_value" disabled />
              </div>
              </div>
            </fieldset>

            <!-- Q8 -->
            <fieldset class="q-container pl-5 pb-3">
            <legend class="q-header pb-1">
              <strong>Q8: How would you describe the condition of the exterior façades?</strong>
            </legend>
            <div id="Q8" class="q-choices survey-2col" >
              <label for="G8"><input id="G8" class="mr-1" type="radio" name="Q8" value="good"  required/>Good</label>
              <label for="F8"><input id="F8" class="mr-1" type="radio" name="Q8" value="fair"  required/>Fair</label>
              <label for="P8"><input id="P8" class="mr-1" type="radio" name="Q8" value="poor"  required/>Poor</label>
              <label for="U8"><input id="U8" class="mr-1" type="radio" name="Q8" value="unsure" required/>Unsure</label>
            </div>
           </fieldset>

            <!-- Q9 -->
            <fieldset class="q-container pl-5 pb-3">
            <legend class="q-header pb-1">
              <strong>Q9: Is there a large proportion of windows to overall façade area?</strong>
            </legend>
            <div id="Q9" class="q-choices survey-2col" >
              <label for="L9"><input id="L9" class="mr-1" type="radio" name="Q9" value="large"  required/>Large</label>
              <label for="M9"><input id="M9" class="mr-1" type="radio" name="Q9" value="medium"  required/>Medium</label>
              <label for="S9"><input id="S9" class="mr-1" type="radio" name="Q9" value="small"  required/>Small</label>
              <label for="U9"><input id="U9" class="mr-1" type="radio" name="Q9" value="unsure" required/>Unsure</label>
            </div>
            </fieldset>

          <!-- Q10 -->
          <fieldset class="q-container pl-5 pb-3">
          <legend class="q-header pb-1">
            <strong>Q10: Are there very large and/or irregularly shaped windows? </strong>
          </legend>
          <div  id="Q10" class="q-choices survey-3col">
            <label for="Y10"><input id="Y10" class="mr-1" type="radio" name="Q10" value="yes" required/>Yes</label>
            <label for="N10"><input id="N10" class="mr-1" type="radio" name="Q10" value="no" required/>No</label>
            <label for="U10"><input id="U10" class="mr-1" type="radio" name="Q10" value="unsure"  required/>Unsure</label>
          </div>
          </fieldset>

          <!-- Q11 -->
          <fieldset class="q-container pl-5 pb-3">
            <legend class="q-header pb-1">
              <strong>Q11: What best describes the roof geometry?</strong>
            </legend>
            <div id="Q11" class="q-choices survey-3col" >
              <label for="Q11_1"><input id="Q11_1" class="mr-1" type="checkbox" name="Q11" value="Flat"  onclick='deRequire("Q11")' required/>Flat</label>
              <label for="Q11_2"><input id="Q11_2" class="mr-1" type="checkbox" name="Q11" value="Pitched"  onclick='deRequire("Q11")' required/>Pitched</label>
              <label for="Q11_3"><input id="Q11_3" class="mr-1" type="checkbox" name="Q11" value="Curved" onclick='deRequire("Q11")' required/>Curved</label>
              <label for="Q11_4"><input id="Q11_4" class="mr-1" type="checkbox" name="Q11" value="Complex"  onclick='deRequire("Q11")' required/>Complex</label>
              <label for="Q11_5"><input id="Q11_5" class="mr-1" type="checkbox" name="Q11" value="U11"  onclick='deRequire("Q11")' required/>Unsure</label>

            <div class = "specify">
              <label for="Q11_61" class = "mr-1"><input id = "Q11_61" type="checkbox" class = "mr-1" name="Q11" onclick='deRequire("Q11"); deDisabled("Q11_61")' required>Other (specify): </label>
              <input id="Q11_6" type = "text"  name="Q11_6_value" disabled />
            </div>
            </div>
          </fieldset>

          <!-- Q12 -->
          <fieldset class="q-container pl-5 pb-3">
            <legend class="q-header pb-1">
              <strong>Q12: What type of structure does the building appear to have?</strong>
            </legend>
            <div id="Q12">
              <label for="Q12_1"><input id="Q12_1" class="mr-1" type="checkbox" name="Q12" value="Wood_frame_or_light_gauge_steel"  onclick='deRequire("Q12")' required/>Wood frame or light gauge steel</label><br>
              <label for="Q12_2"><input id="Q12_2" class="mr-1" type="checkbox" name="Q12" value="Load-bearing_brick_masonry"  onclick='deRequire("Q12")' required/>Load-bearing brick masonry</label><br>
              <label for="Q12_3"><input id="Q12_3" class="mr-1" type="checkbox" name="Q12" value="Load-bearing_stone_masonry"  onclick='deRequire("Q12")' required/>Load-bearing stone masonry</label><br>
              <label for="Q12_4"><input id="Q12_4" class="mr-1" type="checkbox" name="Q12" value="Concrete_frame"  onclick='deRequire("Q12")' required/>Concrete frame</label><br>
              <label for="Q12_5"><input id="Q12_5" class="mr-1" type="checkbox" name="Q12" value="Steel_frame"  onclick='deRequire("Q12")' required/>Steel frame</label><br>
              <label for="Q12_6"><input id="Q12_6" class="mr-1" type="checkbox" name="Q12" value="U12"  onclick='deRequire("Q12")' required/>Unsure</label><br>

            <div class = "specify">
              <label for="Q12_71" class = "mr-1"><input id = "Q12_71" type="checkbox" class = "mr-1" name="Q12" onclick='deRequire("Q12"); deDisabled("Q12_71")' required>Other (specify): </label>
              <input id="Q12_7" type = "text"  name="Q12_7_value" disabled />
            </div>
            </div>
          </fieldset>

          <!-- Q13 -->
          <fieldset id="Q13" class="q-container pl-5 pb-3" >
          <legend class="q-header pb-1">
            <strong>Q13: Does this building look new and/or recently renovated?</strong>
          </legend>
          <div class="q-choices survey-3col">
            <label for="Y13"><input id="Y13" class="mr-1" type="radio" name="Q13" value="yes" required />Yes</label>
            <label for="N13"><input id="N13" class="mr-1" type="radio" name="Q13" value="no"  required/>No</label>
            <label for="U13"><input id="U13" class="mr-1" type="radio" name="Q13" value="unsure"  required/>Unsure</label>
          </div>
          </fieldset>
          {% if  building.construction_year != None %}
             <script>
                document.getElementById("Q13").style.display = "none";
                document.getElementById("Y13").required = false;
                document.getElementById("N13").required = false;
                document.getElementById("U13").required = false;
             </script>
          {% endif %}

            <!--submit the button and close the form -->
            <div class="btn-row">
                <input id="btn-submit-vote" class="btn btn-vote mr-5" type="submit" value="Submit">
            </div>
            <br>

          </form>

        </div>
      </div>

        <!-- This is the satellite map -->
        <div class="tab-pane show active" id="nav-satellite" role="tabpanel" aria-labelledby="nav-satellite-tab"></div>
      </div>

      <div class="map-container">
        <div id="satmap"></div>
      </div>

    </div>
  </div>

  <script src="https://maps.googleapis.com/maps/api/js?key={{key}}&libraries=geometry&callback=initMaps&v=weekly" defer></script>
</section>

{% endblock content %}
